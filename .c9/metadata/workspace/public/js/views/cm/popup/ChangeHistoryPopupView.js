{"changed":true,"filter":false,"title":"ChangeHistoryPopupView.js","tooltip":"/public/js/views/cm/popup/ChangeHistoryPopupView.js","value":"/**\n * 변경 이력 팝업창 \n */\n\ndefine([ \n        'jquery',\n        'underscore',\n        'backbone',\n        'util',\n        'schemas',\n        'grid',\n        'dialog',\n        'datatables',\n        'cmoment',\n        'core/BaseView',\n        'text!templates/default/content.html',\n        'models/cm/ChangeHistoryModel',\n        'collection/cm/ChangeHistoryCollection',\n        'views/component/ProgressbarView'\n], function(\n\t\t$,\n\t\t_,\n\t\tBackbone,\n\t\tUtil,\n\t\tSchemas,\n\t\tGrid,\n\t\tDialog,\n\t\tDatatables,\n\t\tMoment,\n\t\tBaseView,\n\t\tContentHTML,\n\t\tChangeHistoryModel, ChangeHistoryCollection,\n\t\tProgressbarView) {\n\n\tvar ChangeHistoryPopupView = Backbone.View.extend({\n\t\tinitialize : function(data) {\n\t\t\tthis.searchData = data;\n\t\t\tthis.changeHistoryCollection = new ChangeHistoryCollection();\n    \t\t\tthis.gridOption = {\n        \t\t    el:\"changeHistoryDataTable_content\",\n        \t\t    id:\"changeHistoryDataTable\",\n        \t\t    column:[\n    \t                     { data : \"date\", \"title\" : \"일자\" },\n     \t                     //{ data : \"id\", \"title\" : \"ID\", visible: true },\n     \t                     { data : \"name\", \"title\" : \"이름\",\n     \t                    \t \"render\": function (data, type, full, meta) {\n     \t                    \t\t return full.name + \"</br>(\" +full.id + \")\";\n     \t                    \t}\n     \t                     },\n     \t                     { data : \"change_before\", \"title\" : \"변경 전\"},\n     \t                     { data : \"change_after\", \"title\" : \"변경 후\"},\n     \t                     { data : \"change_date\", \"title\" : \"수정 날짜\"},\n     \t                     { data : \"change_name\", \"title\" : \"수정자 이름\",\n\t\t\t\t\"render\": function (data, type, full, meta) {\n\t\t\t\t\treturn full.change_name + \"</br>(\" +full.change_id + \")\";\n\t\t\t\t}\n     \t                     }\n             \t        ],\n        \t\t    collection:this.changeHistoryCollection,\n        \t\t    detail: true,\n        \t\t    buttons:[\"search\"],\n        \t\t    fetch: false\n        \t\t};\n        \t\t// this.on('view:rendered', this.renderGrid, this);\n\t\t},\n\t\tevents: {\n\t\t\t'view:rendered' : \"renderGrid\"\n\t\t},\n\t\trender: function(el) {\n\t\t\tvar dfd= new $.Deferred();\n\t\t\t\n\t\t\tif (!_.isUndefined(el)) this.el=el;\n\t\t\t\n\t\t\tvar _content=$(ContentHTML).attr(\"id\", this.gridOption.el);\n\t\t\t// console.log(_content);\n\t\t\t$(this.el).html(_content);\n\n\t\t\tvar _gridSchema=Schemas.getSchema('grid');\n\t\t    \tthis.grid= new Grid(_gridSchema.getDefault(this.gridOption));\n\t\t\tdfd.resolve(this);\n\t\t\t\n    \t    \t\tthis.progressbar = new ProgressbarView();\n\t\t\t$(this.el).append(this.progressbar.render());\n\t\t\tthis.progressbar.disabledProgressbar(false);\n\t\t        return dfd.promise();\t\t\t\t\n\t\t},\n\t\t\n\t\tafterRender : function(){\n\t\t\tvar _this = this;\n\t\t\tthis.changeHistoryCollection.fetch({ \n\t\t\t\tdata: _this.searchData,\n\t\t\t\tsuccess: function(result) {\n\t\t\t\t \t_this.grid.render();\n\t\t\t\t \t_this.progressbar.disabledProgressbar(true);\n\t\t\t\t},\n\t\t\t\terror : function(result) {\n\t\t\t\t\talert(\"데이터 조회가 실패했습니다.\");\n\t\t\t\t}\n\t\t\t});\n    \t\t }\n\t});\n\t\n\treturn ChangeHistoryPopupView;\n});","undoManager":{"mark":-1,"position":0,"stack":[[{"group":"doc","deltas":[{"start":{"row":74,"column":3},"end":{"row":74,"column":6},"action":"insert","lines":["// "]}]}]]},"ace":{"folds":[],"scrolltop":960,"scrollleft":0,"selection":{"start":{"row":74,"column":6},"end":{"row":74,"column":28},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":{"row":67,"state":"start","mode":"ace/mode/javascript"}},"timestamp":1421651614683}